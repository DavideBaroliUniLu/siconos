<?xml version="1.0" encoding="UTF-8"?>

<!-- SICONOS Model XML file -->

<SiconosModel>
	<Title>title</Title>
	<Author>author</Author>
	<Description>description</Description>
	<Date>date</Date>
	<SchemaXML>/config/xmlschema/SiconosModelSchema-V1.2.xsd</SchemaXML>
	
	<Time>
		<t0>0.0</t0>
		<T>10.0</T>
	</Time>

	<NSDS>
		<DS_Definition>		
			<LagrangianLinearTIDS number='1'>
				<Id> Ball1 </Id>				
				<StepsInMemory>1</StepsInMemory>
				<q0 vectorSize='3'>	1.0 0.0 0.0	</q0>
				<Velocity0  vectorSize='3'>		15.0 0.0 0.0		</Velocity0>
				<Fext vectorPlugin="RBallPlugin:ballFExt"/>
				<M matrixRowSize='3' matrixColSize='3'>	
					<row>1.0 0.0 0.0</row>
					<row>0.0 1.0 0.0</row>
					<row>0.0 0.0 1.0</row>
				</M>			
				<ndof>3</ndof>								
				<K matrixRowSize='3' matrixColSize='3'>
					<row>0.0 0.0 0.0</row>
					<row>0.0 0.0 0.0</row>
					<row>0.0 0.0 0.0</row>
				</K>
				<C matrixRowSize='3' matrixColSize='3'>
					<row>0.0 0.0 0.0</row>
					<row>0.0 0.0 0.0</row>
					<row>0.0 0.0 0.0</row>
				</C>
			</LagrangianLinearTIDS>
			
			<LagrangianLinearTIDS number='2'>
				<Id> Ball2 </Id>				
				<StepsInMemory>1</StepsInMemory>
				<q0 vectorSize='3'>	10.0 0.0 0.0	</q0>
				<Velocity0  vectorSize='3'>	-10.0 0.0  0.0	</Velocity0>
				<Fext vectorPlugin="RBallPlugin:ballFExt"/>
				<M matrixRowSize='3' matrixColSize='3'>	
					<row>1.0 0.0 0.0</row>
					<row>0.0 1.0 0.0</row>
					<row>0.0 0.0 1.0</row>
				</M>			
				<ndof>3</ndof>								
				<K matrixRowSize='3' matrixColSize='3'>
					<row>0.0 0.0 0.0</row>
					<row>0.0 0.0 0.0</row>
					<row>0.0 0.0 0.0</row>
				</K>
				<C matrixRowSize='3' matrixColSize='3'>
					<row>0.0 0.0 0.0</row>
					<row>0.0 0.0 0.0</row>
					<row>0.0 0.0 0.0</row>
				</C>
			</LagrangianLinearTIDS>
			
			<LagrangianLinearTIDS number='3'>
				<Id> Ball3 </Id>				
				<StepsInMemory>1</StepsInMemory>
				<q0 vectorSize='3'>	20.0 0.0 0.0	</q0>
				<Velocity0  vectorSize='3'>	32.0  0.0  0.0	</Velocity0>
				<Fext vectorPlugin="RBallPlugin:ballFExt"/>
				<M matrixRowSize='3' matrixColSize='3'>	
					<row>1.0 0.0 0.0</row>
					<row>0.0 1.0 0.0</row>
					<row>0.0 0.0 1.0</row>
				</M>			
				<ndof>3</ndof>								
				<K matrixRowSize='3' matrixColSize='3'>
					<row>0.0 0.0 0.0</row>
					<row>0.0 0.0 0.0</row>
					<row>0.0 0.0 0.0</row>
				</K>
				<C matrixRowSize='3' matrixColSize='3'>
					<row>0.0 0.0 0.0</row>
					<row>0.0 0.0 0.0</row>
					<row>0.0 0.0 0.0</row>
				</C>
			</LagrangianLinearTIDS>
			
			<LagrangianLinearTIDS number='4'> 
				<Id> Ground </Id>
				<n>2</n>
				<StepsInMemory>1</StepsInMemory>				
				<q0 vectorSize='1'>	0.5	</q0>	
				<Velocity0 vectorSize='1'>	0.0	</Velocity0>
				<Fext vectorPlugin="BallPlugin:groundFExt"/>
				<M matrixRowSize='1' matrixColSize='1'>	
					<row>1000000.0 </row>
				</M>			
				<ndof>1</ndof>								
				<K matrixRowSize='1' matrixColSize='1'>
					<row>0.0</row>
				</K>
				<C matrixRowSize='1' matrixColSize='1'>
					<row>0.0</row>
				</C>
			</LagrangianLinearTIDS>
			
			<LagrangianLinearTIDS number='5'> 
				<Id> Ceiling </Id>
				<n>2</n>
				<StepsInMemory>1</StepsInMemory>				
				<q0 vectorSize='1'>	30.0	</q0>	
				<Velocity0 vectorSize='1'>	0.0	</Velocity0>
				<Fext vectorPlugin="BallPlugin:groundFExt"/>
				<M matrixRowSize='1' matrixColSize='1'>	
					<row>1000000.0 </row>
				</M>			
				<ndof>1</ndof>								
				<K matrixRowSize='1' matrixColSize='1'>
					<row>0.0</row>
				</K>
				<C matrixRowSize='1' matrixColSize='1'>
					<row>0.0</row>
				</C>
			</LagrangianLinearTIDS>
		</DS_Definition>


		<Interaction_Definition>
			<Interaction number='1'>
				<Status>0</Status>
				<Id>Ball1-Ball2</Id>
				<nInter> 1 </nInter>
				<DS_Concerned>
					<DS number='1' interactsWithDS_Number='2'/>
				</DS_Concerned>

				<Interaction_Content>		
					<LagrangianLinear>
						<H matrixRowSize='1' matrixColSize='6'>
							<row> -1.0  0.0  0.0  1.0  0.0  0.0</row>
						</H>
						<b vectorSize='1'>	0.0	</b>
					</LagrangianLinear>
	
					<NewtonImpactLaw>
						<e>0.9</e>				
					</NewtonImpactLaw>
				</Interaction_Content>	
			</Interaction>
			
			<Interaction number='2'>
				<Status>0</Status>
				<Id>Ball2-Ball3</Id>
				<nInter> 1 </nInter>
				<DS_Concerned>
					<DS number='2' interactsWithDS_Number='3'/>
				</DS_Concerned>

				<Interaction_Content>		
					<LagrangianLinear>
						<H matrixRowSize='1' matrixColSize='6'>
							<row> -1.0  0.0  0.0  1.0  0.0  0.0</row>
						</H>
						<b vectorSize='1'>	0.0	</b>
					</LagrangianLinear>
	
					<NewtonImpactLaw>
						<e>0.9</e>				
					</NewtonImpactLaw>
				</Interaction_Content>	
			</Interaction>
			
			<Interaction number='3'>
				<Status>0</Status>
				<Id>Ball1-Ball3</Id>
				<nInter> 1 </nInter>
				<DS_Concerned>
					<DS number='1' interactsWithDS_Number='3'/>
				</DS_Concerned>

				<Interaction_Content>		
					<LagrangianLinear>
						<H matrixRowSize='1' matrixColSize='6'>
							<row> -1.0  0.0  0.0  1.0  0.0  0.0</row>
						</H>
						<b vectorSize='1'>	0.0	</b>
					</LagrangianLinear>
	
					<NewtonImpactLaw>
						<e>0.9</e>				
					</NewtonImpactLaw>
				</Interaction_Content>
			</Interaction>
			
			<Interaction number='4'>
				<Status>0</Status>
				<Id>Ball1-Ground</Id>
				<nInter> 1 </nInter>
				<DS_Concerned>
					<DS number='1' interactsWithDS_Number='4'/>
				</DS_Concerned>

				<Interaction_Content>		
					<LagrangianLinear>
						<H matrixRowSize='1' matrixColSize='4'>
							<row> 1.0  0.0  0.0  -1.0</row>
						</H>
						<b vectorSize='1'>	0.0	</b>
					</LagrangianLinear>
	
					<NewtonImpactLaw>
						<e>0.9</e>				
					</NewtonImpactLaw>
				</Interaction_Content>	
			</Interaction>
			
			<Interaction number='5'>
				<Status>0</Status>
				<Id>Ball3-Ceiling</Id>
				<nInter> 1 </nInter>
				<DS_Concerned>
					<DS number='3' interactsWithDS_Number='5'/>
				</DS_Concerned>

				<Interaction_Content>		
					<LagrangianLinear>
						<H matrixRowSize='1' matrixColSize='4'>
							<row> -1.0  0.0  0.0  1.0</row>
						</H>
						<b vectorSize='1'>	0.0	</b>
					</LagrangianLinear>
	
					<NewtonImpactLaw>
						<e>0.9</e>				
					</NewtonImpactLaw>
				</Interaction_Content>	
			</Interaction>
			
		</Interaction_Definition>		
	</NSDS>


	<Strategy type='TimeStepping'>

		<TimeDiscretisation isConstant='true'>	
			<h>0.005</h>
			<tk vectorSize='2'>0 0</tk>
			<hMin>0</hMin>
			<hMax>0</hMax>
		</TimeDiscretisation>				

		<OneStepIntegrator_Definition>
			<Moreau>
				<DS_Concerned> <!-- Scaling -->
					<DS number='1'/>
				</DS_Concerned>		
				<Theta> 1.0</Theta>
			</Moreau>					

			<Moreau>
				<DS_Concerned>
					<DS number='2'/>
				</DS_Concerned>
				<Theta> 0.5</Theta>
			</Moreau>
			
			<Moreau>
				<DS_Concerned>
					<DS number='3'/>
				</DS_Concerned>
				<Theta> 0.5</Theta>
			</Moreau>
			
			<Moreau>
				<DS_Concerned>
					<DS number='4'/>
				</DS_Concerned>
				<Theta> 1.0</Theta>
			</Moreau>
			
			<Moreau>
				<DS_Concerned>
					<DS number='5'/>
				</DS_Concerned>
				<Theta> 1.0</Theta>
			</Moreau>

		</OneStepIntegrator_Definition>

		<OneStepNSProblem>
		 	<LCP>
				<n>1</n>			
				<Interaction_Concerned>
					<Interaction number='1'/>
					<Interaction number='2'/>
					<Interaction number='3'/>
					<Interaction number='4'/>
					<Interaction number='5'/>
				</Interaction_Concerned>
		 	</LCP>
		 	<Solver>
				<LcpSolving>
					<Gsnl maxIter="101" tolerance="0.0001" normType="max"/>
				</LcpSolving>
			</Solver>
		 </OneStepNSProblem>
	</Strategy>
	
</SiconosModel>
