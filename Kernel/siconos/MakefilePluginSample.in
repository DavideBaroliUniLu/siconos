# Siconos-Kernel version 1.1.1, Copyright INRIA 2005-2006.
# Siconos is a program dedicated to modeling, simulation and control
# of non smooth dynamical systems.	
# Siconos is a free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version.
# Siconos is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with Siconos; if not, write to the Free Software
# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
#
# Contact: Vincent ACARY vincent.acary@inrialpes.fr 
#	
SICONOSPATH=@prefix@
include $(SICONOSPATH)/share/SICONOS/KernelConfig.sh

SAMPLE_SOURCES = $(OBJ)
SAMPLE_OBJ  = $(patsubst %.cpp,%.o,  $(SAMPLE_SOURCES))
SAMPLE_EXE  = $(patsubst %.cpp,%_EXE,  $(SAMPLE_SOURCES))

C_SOURCES = $(wildcard *.c)
C_OBJ  = $(patsubst %.c,%.o,  $(C_SOURCES))

sample:$(SAMPLE_OBJ) $(SAMPLE_EXE)
	
.cpp.o:
	$(CXX) -c $(CXXFLAGS) $(LIBEXT_INCLUDES) -I $(SICONOSPATH)/include $<

$(SAMPLE_EXE):$(SAMPLE_OBJ)
	echo "$(SAMPLE_EXE):"
#	$(CXX) -o $@ $< $(LIBEXT_LDFLAGS) -L$(SICONOSPATH)/lib -lSiconosKernel
	$(CXX) -o $@ $< $(SICONOS_LDFLAGS) 

run:$(SAMPLE_EXE) 
	./$(SAMPLE_EXE)

#cleansample:
#	rm -f *_EXE *.o *.output;


PLUGIN_SOURCES = $(wildcard *Plugin.cpp)
PLUGIN_OBJ  = $(patsubst %.cpp,%.o,  $(PLUGIN_SOURCES))
PLUGIN_LIB = $(patsubst %.cpp,%.so,  $(PLUGIN_SOURCES))

plugin:$(PLUGIN_OBJ) $(PLUGIN_LIB)

	
.c.o:
	$(CC) -c $(CXXFLAGS) $<

%.so:%.cpp $(C_OBJ)
	$(CXX) $(CXX_DYNLIB) $(C_OBJ) $< -o $@

#cleanplugin:
#	rm -f $(PLUGIN_OBJ) $(PLUGIN_LIB)


#clean:cleansample cleanplugin
clean:	
	rm -f *_EXE *.o *.output *.so;
