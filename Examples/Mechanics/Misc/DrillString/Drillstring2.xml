<?xml version="1.0" encoding="UTF-8"?>
<!-- Siconos-Examples version 3.0.0, Copyright INRIA 2005-2008.-->
<!-- Siconos is a program dedicated to modeling, simulation and control-->
<!-- of non smooth dynamical systems.	-->
<!-- Siconos is a free software; you can redistribute it and/or modify-->
<!-- it under the terms of the GNU General Public License as published by-->
<!-- the Free Software Foundation; either version 2 of the License, or-->
<!-- (at your option) any later version.-->
<!-- Siconos is distributed in the hope that it will be useful,-->
<!-- but WITHOUT ANY WARRANTY; without even the implied warranty of-->
<!-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the-->
<!-- GNU General Public License for more details.-->
<!---->
<!-- You should have received a copy of the GNU General Public License-->
<!-- along with Siconos; if not, write to the Free Software-->
<!-- Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA-->
<!---->
<!-- Contact: Vincent ACARY vincent.acary@inrialpes.fr -->
<!--	-->

<!-- SICONOS Model XML file -->

<SiconosModel>
	<Title>Drill-string system</Title>
  <Author>A.Doris - P.Piiroinen</Author>
  <Description>Drill -striing system with Coulomb and viscus friction </Description>
  <Date>date</Date>
 	<Time>
		<t0>0.0</t0>
		<T>50.0</T>
	</Time>
	<NSDS bvp='false'>
	
		<!-- DSs defined in the problem -->
		<DS_Definition>		
			<LagrangianDS number='1'>
				<Id>Upper and lower disc </Id>				
				<StepsInMemory>1</StepsInMemory>				
				<q0 vectorSize='4'>
					0.1 0.0 0.0 4.0
				</q0>
				<Velocity0  vectorSize='4'>
					0.0 4.1 0.0 0.0
				</Velocity0>
				<FExt vectorPlugin="DS2Plugin:FExt"/>
				<FInt vectorPlugin="DS2Plugin:FInt"/>
				<NNL vectorPlugin="DS2Plugin:NNL"/>
				<Mass matrixRowSize='4' matrixColSize='4'>	
					<row> 0.4765 0.0    0.0  0.0 </row>
					<row> 0.0    0.0414 0.0  0.0 </row>
                    	                <row> 0.0    0.0    1.0  0.0 </row>
	                                <row> 0.0    0.0    0.0  1.0 </row>
				</Mass>			
			</LagrangianDS>
		</DS_Definition>
		<!-- Interactions defined in the problem -->		
		<Interaction_Definition>
			<Interaction number='1' Id='inter1'>
				<size>2</size>
				<!-- List of couple of DS concerned by this interaction -->
		                <DS_Concerned all='true'>
                                </DS_Concerned>									
				<!-- Relation of this interaction -->				
				<Interaction_Content>		
				 <LagrangianLinearRelation>
				  <H matrixRowSize='2' matrixColSize='4'>
  	                            <row> 0.0 0.0 0.0 1.0 </row>
  	                            <row> 0.0 1.0 0.0 0.0 </row>
                                  </H>
  				 </LagrangianLinearRelation>			
				<!-- NS Law of this interaction	-->
				<NewtonImpactFrictionLaw>
					<size>2</size>			 
					<en>0.0</en>				
                                  <mu>1.0</mu>
				</NewtonImpactFrictionLaw>
				</Interaction_Content>	
			</Interaction>
	                <Interaction number='2' Id='inter2'> 
				<size>2</size>
				<!-- List of couple of DS concerned by this interaction -->
		                <DS_Concerned all='true'>
                                </DS_Concerned>									
				<!-- Relation of this interaction -->				
				<Interaction_Content>		
				 <LagrangianLinearRelation>
				  <H matrixRowSize='2' matrixColSize='4'>
  	                            <row> 0.0 0.0 1.0 0.0 </row>
  	                            <row> 1.0 0.0 0.0 0.0 </row>
                                  </H>
  				 </LagrangianLinearRelation>			
				<!-- NS Law of this interaction	-->
				<NewtonImpactFrictionLaw>
				  <size>2</size>
  				  <en>0.0</en>				
                                  <mu>1.0</mu>
				</NewtonImpactFrictionLaw>
				</Interaction_Content>	
			</Interaction>						
		</Interaction_Definition>		
	</NSDS>
	<!-- Simulation to use in order to solve the problem -->	
	<Simulation type='TimeStepping'>
		<TimeDiscretisation isConstant='true'>	
			<h>0.005</h>
     		</TimeDiscretisation>				
		<!-- One Step Integrators -->				
		<OneStepIntegrator_Definition>
			<Moreau>
				<DS_Concerned vectorSize='1'>1</DS_Concerned>	
				<Theta vectorSize='1'> 0.5</Theta>
			</Moreau>					
		</OneStepIntegrator_Definition>
		<!-- One Step NS Problem of th Simulation-->
		<OneStepNSProblem>
		 	<FrictionContact2D>
                        <Solver type="NLGS" maxIter="101" tolerance="0.0001" directionSearch="0.6"/>
		 	</FrictionContact2D>
		 </OneStepNSProblem>
	</Simulation>	
</SiconosModel>
